<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care</title>
  <meta name="description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="A R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://daynefiler.com/dissertation/_book/" />
  
  <meta property="og:description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  <meta name="github-repo" content="daynefiler/dissertation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care" />
  
  <meta name="twitter:description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  

<meta name="author" content="Dayne Lewis Filer" />


<meta name="date" content="2020-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="references.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front matter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright"><i class="fa fa-check"></i>Copyright</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i>Dedication</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#humGenPrime"><i class="fa fa-check"></i><b>1.2</b> Human Genetics Primer</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#dnaDiscover"><i class="fa fa-check"></i><b>1.2.1</b> Discovery of DNA and the central dogma</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#genVar"><i class="fa fa-check"></i><b>1.2.2</b> Genetic variation in humans</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#sequencing"><i class="fa fa-check"></i><b>1.3</b> DNA Sequencing</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#firstGen"><i class="fa fa-check"></i><b>1.3.1</b> First-generation sequencing</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#secGen"><i class="fa fa-check"></i><b>1.3.2</b> Second-generation sequencing</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#illumina"><i class="fa fa-check"></i><b>1.3.3</b> Illumina sequencing</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#seqData"><i class="fa fa-check"></i><b>1.3.4</b> Processing short-read sequencing data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#medGen"><i class="fa fa-check"></i><b>1.4</b> Development of Medical Genetics</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#prob"><i class="fa fa-check"></i><b>1.5</b> Rationale</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html"><i class="fa fa-check"></i><b>2</b> A novel copy number variant algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#methods"><i class="fa fa-check"></i><b>2.2</b> Methods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#exome-sequencing"><i class="fa fa-check"></i><b>2.2.1</b> Exome sequencing</a></li>
<li class="chapter" data-level="2.2.2" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#genome-sequencing"><i class="fa fa-check"></i><b>2.2.2</b> Genome sequencing</a></li>
<li class="chapter" data-level="2.2.3" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#simulating-targeted-sequencing"><i class="fa fa-check"></i><b>2.2.3</b> Simulating targeted sequencing</a></li>
<li class="chapter" data-level="2.2.4" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#mccnv-algorithm"><i class="fa fa-check"></i><b>2.2.4</b> mcCNV algorithm</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#results"><i class="fa fa-check"></i><b>2.3</b> Results</a><ul>
<li class="chapter" data-level="2.3.1" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#multiplexed-capture-reduces-inter-sample-variance"><i class="fa fa-check"></i><b>2.3.1</b> Multiplexed capture reduces inter-sample variance</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#multiplexed-capture-provides-controls-for-exomedepth"><i class="fa fa-check"></i><b>2.3.2</b> Multiplexed capture provides controls for ExomeDepth</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#mccnv-exomedepth-perform-comparably-in-simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> mcCNV &amp; ExomeDepth perform comparably in simulation study</a></li>
<li class="chapter" data-level="2.3.4" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#mccnv-exomedepth-perform-comparably-on-wgs-pool"><i class="fa fa-check"></i><b>2.3.4</b> mcCNV &amp; ExomeDepth perform comparably on WGS pool</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-novel-copy-number-variant-algorithm.html"><a href="a-novel-copy-number-variant-algorithm.html#discussion"><i class="fa fa-check"></i><b>2.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><i class="fa fa-check"></i><b>3</b> Shortcomings of exome sequencing in noninvasive prenatal genetics</a><ul>
<li class="chapter" data-level="3.1" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#methods-1"><i class="fa fa-check"></i><b>3.2</b> Methods</a><ul>
<li class="chapter" data-level="3.2.1" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#participant-selection"><i class="fa fa-check"></i><b>3.2.1</b> Participant selection</a></li>
<li class="chapter" data-level="3.2.2" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#exome-sequencing-and-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Exome sequencing and analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#genotyping-algorithm"><i class="fa fa-check"></i><b>3.2.3</b> Genotyping algorithm</a></li>
<li class="chapter" data-level="3.2.4" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#data-availability"><i class="fa fa-check"></i><b>3.2.4</b> Data availability</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#results-1"><i class="fa fa-check"></i><b>3.3</b> Results</a></li>
<li class="chapter" data-level="3.4" data-path="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html"><a href="shortcomings-of-exome-sequencing-in-noninvasive-prenatal-genetics.html#discussion-1"><i class="fa fa-check"></i><b>3.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="r-code.html"><a href="r-code.html"><i class="fa fa-check"></i><b>A</b> R Code</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools and statistical approaches for integrating DNA sequencing into clinical care</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-code" class="section level1">
<h1><span class="header-section-number">A</span> R Code</h1>
<p>This appendix contains all of the R code to reproduce the work presented.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="r-code.html#cb1-1"></a><span class="kw">options</span>(<span class="dt">knitr.graphics.auto_pdf =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-2"><a href="r-code.html#cb1-2"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(</span>
<span id="cb1-3"><a href="r-code.html#cb1-3"></a>  <span class="dt">echo      =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-4"><a href="r-code.html#cb1-4"></a>  <span class="dt">warning   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-5"><a href="r-code.html#cb1-5"></a>  <span class="dt">message   =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-6"><a href="r-code.html#cb1-6"></a>  <span class="dt">error     =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-7"><a href="r-code.html#cb1-7"></a>  <span class="dt">cache     =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-8"><a href="r-code.html#cb1-8"></a>  <span class="dt">fig.align =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb1-9"><a href="r-code.html#cb1-9"></a>  <span class="dt">fig.width =</span> <span class="dv">5</span>,</span>
<span id="cb1-10"><a href="r-code.html#cb1-10"></a>  <span class="dt">fig.height =</span> <span class="dv">4</span>,</span>
<span id="cb1-11"><a href="r-code.html#cb1-11"></a>  <span class="dt">dev.args =</span> <span class="kw">list</span>(<span class="dt">pdf =</span> <span class="kw">list</span>(<span class="dt">pointsize =</span> <span class="dv">10</span>),</span>
<span id="cb1-12"><a href="r-code.html#cb1-12"></a>                  <span class="dt">png =</span> <span class="kw">list</span>(<span class="dt">pointsize =</span> <span class="dv">10</span>)),</span>
<span id="cb1-13"><a href="r-code.html#cb1-13"></a>  <span class="dt">dpi =</span> <span class="dv">300</span></span>
<span id="cb1-14"><a href="r-code.html#cb1-14"></a>)</span>
<span id="cb1-15"><a href="r-code.html#cb1-15"></a>tex  &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb1-16"><a href="r-code.html#cb1-16"></a>docx &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-17"><a href="r-code.html#cb1-17"></a>html &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-18"><a href="r-code.html#cb1-18"></a><span class="cf">if</span> (<span class="op">!</span>knitr<span class="op">:::</span><span class="kw">is_latex_output</span>()) {</span>
<span id="cb1-19"><a href="r-code.html#cb1-19"></a>    tex &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-20"><a href="r-code.html#cb1-20"></a>    <span class="cf">if</span> (knitr<span class="op">:::</span><span class="kw">is_html_output</span>()) {</span>
<span id="cb1-21"><a href="r-code.html#cb1-21"></a>        html &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb1-22"><a href="r-code.html#cb1-22"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-23"><a href="r-code.html#cb1-23"></a>        docx &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb1-24"><a href="r-code.html#cb1-24"></a>    }</span>
<span id="cb1-25"><a href="r-code.html#cb1-25"></a>}</span>
<span id="cb1-26"><a href="r-code.html#cb1-26"></a><span class="kw">library</span>(filer2020A)</span>
<span id="cb1-27"><a href="r-code.html#cb1-27"></a><span class="kw">library</span>(filer2020B)</span>
<span id="cb1-28"><a href="r-code.html#cb1-28"></a><span class="kw">library</span>(mcCNV)</span>
<span id="cb1-29"><a href="r-code.html#cb1-29"></a><span class="kw">library</span>(xtable)</span>
<span id="cb1-30"><a href="r-code.html#cb1-30"></a><span class="kw">library</span>(eulerr)</span>
<span id="cb1-31"><a href="r-code.html#cb1-31"></a><span class="kw">library</span>(dlfUtils)</span>
<span id="cb1-32"><a href="r-code.html#cb1-32"></a><span class="kw">library</span>(parallel)</span>
<span id="cb1-33"><a href="r-code.html#cb1-33"></a><span class="kw">library</span>(grid)</span>
<span id="cb1-34"><a href="r-code.html#cb1-34"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb1-35"><a href="r-code.html#cb1-35"></a><span class="kw">library</span>(MASS)</span>
<span id="cb1-36"><a href="r-code.html#cb1-36"></a>defOutWid &lt;-<span class="st"> </span><span class="cf">if</span> (html) <span class="st">&#39;70%&#39;</span> <span class="cf">else</span> <span class="ot">NULL</span></span>
<span id="cb1-37"><a href="r-code.html#cb1-37"></a>dblOutWid &lt;-<span class="st"> </span><span class="cf">if</span> (html) <span class="st">&#39;40%&#39;</span> <span class="cf">else</span> <span class="st">&#39;49%&#39;</span></span>
<span id="cb1-38"><a href="r-code.html#cb1-38"></a><span class="kw">data</span>(subjectMeta)</span>
<span id="cb1-39"><a href="r-code.html#cb1-39"></a>poolTbl &lt;-<span class="st"> </span>subjectMeta[ ,</span>
<span id="cb1-40"><a href="r-code.html#cb1-40"></a>                       .(<span class="dt">N =</span> .N,</span>
<span id="cb1-41"><a href="r-code.html#cb1-41"></a>                         <span class="dt">medExon =</span> <span class="kw">round</span>(<span class="kw">median</span>(medIntMolCount), <span class="dv">0</span>),</span>
<span id="cb1-42"><a href="r-code.html#cb1-42"></a>                         <span class="dt">medTotal =</span> <span class="kw">round</span>(<span class="kw">median</span>(totalMolCount), <span class="dv">0</span>),</span>
<span id="cb1-43"><a href="r-code.html#cb1-43"></a>                         <span class="dt">minTotal =</span> <span class="kw">min</span>(totalMolCount),</span>
<span id="cb1-44"><a href="r-code.html#cb1-44"></a>                         <span class="dt">maxTotal =</span> <span class="kw">max</span>(totalMolCount),</span>
<span id="cb1-45"><a href="r-code.html#cb1-45"></a>                         <span class="dt">rsdTotal =</span> <span class="kw">sd</span>(totalMolCount)<span class="op">/</span><span class="kw">mean</span>(totalMolCount)<span class="op">*</span><span class="dv">100</span>),</span>
<span id="cb1-46"><a href="r-code.html#cb1-46"></a>                       by =<span class="st"> </span>.(pool, capture, multiplexCapture)]</span>
<span id="cb1-47"><a href="r-code.html#cb1-47"></a>poolTbl[ , rsdTotal <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">round</span>(rsdTotal, <span class="dv">1</span>)]</span>
<span id="cb1-48"><a href="r-code.html#cb1-48"></a>poolTbl[(<span class="op">!</span>multiplexCapture), pool <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(pool, <span class="st">&quot;$^</span><span class="ch">\\</span><span class="st">dagger$&quot;</span>)]</span>
<span id="cb1-49"><a href="r-code.html#cb1-49"></a><span class="kw">kable</span>(poolTbl[ , .(pool, capture, N, medExon, medTotal, minTotal, maxTotal, rsdTotal)], </span>
<span id="cb1-50"><a href="r-code.html#cb1-50"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>, </span>
<span id="cb1-51"><a href="r-code.html#cb1-51"></a>      <span class="dt">caption =</span> <span class="st">&#39;Summary of whole-exome sequencing. “pool” indicates the name of the pool of samples; “capture” indicates the capture platform for the pool; “N” gives the number of samples in the pool; “medExon” gives the pool median of the subject median mapped molecule count per exon; “medTotal” gives the median by pool of total mapped molecule counts per subject; “minTotal” and “maxTotal” give the minimum and maximum total mapped molecules; “rsdTotal” gives the relative standard deviation (SD/mean*100) of total mapped molecules. <span class="math inline">\(^\dagger\)</span> indicates captures were performed independently on each sample within the pool, otherwise captures were multiplexed across all samples within the pool.&#39;</span>,</span>
<span id="cb1-52"><a href="r-code.html#cb1-52"></a>      <span class="dt">label =</span> <span class="st">&quot;poolSummary&quot;</span>,</span>
<span id="cb1-53"><a href="r-code.html#cb1-53"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-54"><a href="r-code.html#cb1-54"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-55"><a href="r-code.html#cb1-55"></a>      <span class="dt">caption.short =</span> <span class="st">&quot;Summary of whole-exome sequencing for CNV project.&quot;</span>,</span>
<span id="cb1-56"><a href="r-code.html#cb1-56"></a>      <span class="dt">escape =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-57"><a href="r-code.html#cb1-57"></a><span class="st">  </span><span class="kw">kable_classic</span>()</span>
<span id="cb1-58"><a href="r-code.html#cb1-58"></a><span class="co">## Create IC pools</span></span>
<span id="cb1-59"><a href="r-code.html#cb1-59"></a>smplSubject &lt;-<span class="st"> </span><span class="cf">function</span>(poolName, n) {</span>
<span id="cb1-60"><a href="r-code.html#cb1-60"></a>  <span class="kw">data</span>(subjectMeta, <span class="dt">envir =</span> <span class="kw">environment</span>())</span>
<span id="cb1-61"><a href="r-code.html#cb1-61"></a>  subjectMeta[pool <span class="op">==</span><span class="st"> </span>poolName, <span class="kw">sample</span>(subject, n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)]</span>
<span id="cb1-62"><a href="r-code.html#cb1-62"></a>}</span>
<span id="cb1-63"><a href="r-code.html#cb1-63"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-64"><a href="r-code.html#cb1-64"></a>pools &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">smplSubject</span>(<span class="st">&quot;NCGENES&quot;</span>, <span class="dv">16</span>), <span class="dt">simplify =</span> <span class="ot">FALSE</span>))</span>
<span id="cb1-65"><a href="r-code.html#cb1-65"></a><span class="kw">names</span>(pools) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sprintf</span>(<span class="st">&quot;randNCG_%d&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>))</span>
<span id="cb1-66"><a href="r-code.html#cb1-66"></a>pools &lt;-<span class="st"> </span><span class="kw">c</span>(pools,</span>
<span id="cb1-67"><a href="r-code.html#cb1-67"></a>           <span class="kw">with</span>(subjectMeta[pool <span class="op">!=</span><span class="st"> &quot;NCGENES&quot;</span>], <span class="kw">split</span>(subject, pool)))</span>
<span id="cb1-68"><a href="r-code.html#cb1-68"></a><span class="co">## Calculate mean-variance by pool</span></span>
<span id="cb1-69"><a href="r-code.html#cb1-69"></a>mnvr &lt;-<span class="st"> </span><span class="kw">mclapply</span>(pools, subsetCounts, <span class="dt">mc.cores =</span> <span class="kw">length</span>(pools))</span>
<span id="cb1-70"><a href="r-code.html#cb1-70"></a>mnvr &lt;-<span class="st"> </span><span class="kw">mclapply</span>(mnvr, calcIntStats, <span class="dt">mc.cores =</span> <span class="kw">length</span>(mnvr))</span>
<span id="cb1-71"><a href="r-code.html#cb1-71"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(mnvr)) {</span>
<span id="cb1-72"><a href="r-code.html#cb1-72"></a>  mnvr[[i]][ , pool <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">names</span>(mnvr)[i]]</span>
<span id="cb1-73"><a href="r-code.html#cb1-73"></a>}</span>
<span id="cb1-74"><a href="r-code.html#cb1-74"></a>mnvr &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(mnvr)</span>
<span id="cb1-75"><a href="r-code.html#cb1-75"></a><span class="kw">setkey</span>(mnvr, pool); <span class="kw">setcolorder</span>(mnvr)</span>
<span id="cb1-76"><a href="r-code.html#cb1-76"></a></span>
<span id="cb1-77"><a href="r-code.html#cb1-77"></a><span class="co">## Estimate alpha0</span></span>
<span id="cb1-78"><a href="r-code.html#cb1-78"></a>alpha0 &lt;-<span class="st"> </span><span class="kw">mclapply</span>(pools, estAlpha0, <span class="dt">mc.cores =</span> <span class="kw">length</span>(pools))</span>
<span id="cb1-79"><a href="r-code.html#cb1-79"></a>a0tbl &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">pool =</span> <span class="kw">names</span>(alpha0),</span>
<span id="cb1-80"><a href="r-code.html#cb1-80"></a>                    <span class="dt">a0 =</span> <span class="kw">sapply</span>(alpha0, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;a0&quot;</span>),</span>
<span id="cb1-81"><a href="r-code.html#cb1-81"></a>                    <span class="dt">N =</span> <span class="kw">sapply</span>(alpha0, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;N&quot;</span>))</span>
<span id="cb1-82"><a href="r-code.html#cb1-82"></a>a0tbl[ , aMn <span class="op">:</span><span class="er">=</span><span class="st"> </span>a0<span class="op">/</span>N]</span>
<span id="cb1-83"><a href="r-code.html#cb1-83"></a>calcRange &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb1-84"><a href="r-code.html#cb1-84"></a>  subjectMeta[subject <span class="op">%in%</span><span class="st"> </span>x,</span>
<span id="cb1-85"><a href="r-code.html#cb1-85"></a>              .(<span class="dt">mnCount =</span> <span class="kw">min</span>(totalMolCount),</span>
<span id="cb1-86"><a href="r-code.html#cb1-86"></a>                <span class="dt">mdCount =</span> <span class="kw">median</span>(totalMolCount),</span>
<span id="cb1-87"><a href="r-code.html#cb1-87"></a>                <span class="dt">mxCount =</span> <span class="kw">max</span>(totalMolCount),</span>
<span id="cb1-88"><a href="r-code.html#cb1-88"></a>                <span class="dt">rsCount =</span> <span class="kw">sd</span>(totalMolCount)<span class="op">/</span><span class="kw">mean</span>(totalMolCount)<span class="op">*</span><span class="dv">100</span>)]</span>
<span id="cb1-89"><a href="r-code.html#cb1-89"></a>}</span>
<span id="cb1-90"><a href="r-code.html#cb1-90"></a>poolCts &lt;-<span class="st"> </span><span class="kw">lapply</span>(pools, calcRange)</span>
<span id="cb1-91"><a href="r-code.html#cb1-91"></a>poolCts &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">names</span>(poolCts), <span class="cf">function</span>(x) poolCts[[x]][ , <span class="dt">pool :=</span> x])</span>
<span id="cb1-92"><a href="r-code.html#cb1-92"></a>poolCts &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(poolCts)</span>
<span id="cb1-93"><a href="r-code.html#cb1-93"></a>a0tbl &lt;-<span class="st"> </span><span class="kw">merge</span>(a0tbl, poolCts)</span>
<span id="cb1-94"><a href="r-code.html#cb1-94"></a>a0tbl[ , mc <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;IDT-IC|rand&quot;</span>, pool)]</span>
<span id="cb1-95"><a href="r-code.html#cb1-95"></a>a0tbl[ , idt <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;IDT&quot;</span>, pool)]</span>
<span id="cb1-96"><a href="r-code.html#cb1-96"></a><span class="kw">pltAlpha0</span>(a0tbl)</span>
<span id="cb1-97"><a href="r-code.html#cb1-97"></a>aglPools &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sprintf</span>(<span class="st">&quot;randNCG_%d&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="st">&quot;Pool1&quot;</span>, <span class="st">&quot;Pool2&quot;</span>, <span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;SMA1&quot;</span>, <span class="st">&quot;SMA2&quot;</span>)</span>
<span id="cb1-98"><a href="r-code.html#cb1-98"></a><span class="kw">with</span>(mnvr[pool <span class="op">%in%</span><span class="st"> </span>aglPools], {</span>
<span id="cb1-99"><a href="r-code.html#cb1-99"></a>  <span class="kw">pltMnVrCont</span>(<span class="dt">dat =</span> <span class="kw">as.data.table</span>(<span class="kw">as.list</span>(<span class="kw">environment</span>())),</span>
<span id="cb1-100"><a href="r-code.html#cb1-100"></a>              <span class="dt">grpVec =</span> <span class="kw">factor</span>(pool, <span class="dt">levels =</span> aglPools),</span>
<span id="cb1-101"><a href="r-code.html#cb1-101"></a>              <span class="dt">colVec =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;darkblue&#39;</span>, <span class="dv">5</span>), <span class="kw">rep</span>(<span class="st">&#39;darkorange&#39;</span>, <span class="dv">5</span>)),</span>
<span id="cb1-102"><a href="r-code.html#cb1-102"></a>              <span class="dt">lgnd =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-103"><a href="r-code.html#cb1-103"></a>})</span>
<span id="cb1-104"><a href="r-code.html#cb1-104"></a>idtPools &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;IDT-MC&quot;</span>, <span class="st">&quot;IDT-IC&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)</span>
<span id="cb1-105"><a href="r-code.html#cb1-105"></a><span class="kw">with</span>(mnvr[pool <span class="op">%in%</span><span class="st"> </span>idtPools], {</span>
<span id="cb1-106"><a href="r-code.html#cb1-106"></a>  <span class="kw">pltMnVrCont</span>(<span class="dt">dat =</span> <span class="kw">as.data.table</span>(<span class="kw">as.list</span>(<span class="kw">environment</span>())),</span>
<span id="cb1-107"><a href="r-code.html#cb1-107"></a>              <span class="dt">grpVec =</span> <span class="kw">factor</span>(pool, <span class="dt">levels =</span> idtPools),</span>
<span id="cb1-108"><a href="r-code.html#cb1-108"></a>              <span class="dt">colVec =</span> <span class="kw">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>),</span>
<span id="cb1-109"><a href="r-code.html#cb1-109"></a>              <span class="dt">lgnd =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-110"><a href="r-code.html#cb1-110"></a>})</span>
<span id="cb1-111"><a href="r-code.html#cb1-111"></a><span class="kw">with</span>(mnvr[pool <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)], {</span>
<span id="cb1-112"><a href="r-code.html#cb1-112"></a>  <span class="kw">pltMnVrCont</span>(<span class="dt">dat =</span> <span class="kw">as.data.table</span>(<span class="kw">as.list</span>(<span class="kw">environment</span>())),</span>
<span id="cb1-113"><a href="r-code.html#cb1-113"></a>              <span class="dt">grpVec =</span> <span class="kw">factor</span>(pool, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)),</span>
<span id="cb1-114"><a href="r-code.html#cb1-114"></a>              <span class="dt">colVec =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>))</span>
<span id="cb1-115"><a href="r-code.html#cb1-115"></a>})</span>
<span id="cb1-116"><a href="r-code.html#cb1-116"></a><span class="kw">pltSubjectStatByPool</span>(<span class="st">&quot;medIntMolCount&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Median count per exon&quot;</span>)</span>
<span id="cb1-117"><a href="r-code.html#cb1-117"></a><span class="kw">pltSubjectStatByPool</span>(<span class="st">&quot;nSelected&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Number of controls selected&quot;</span>)</span>
<span id="cb1-118"><a href="r-code.html#cb1-118"></a><span class="kw">pltSubjectStatByPool</span>(<span class="st">&quot;propSelected&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proportion of controls selected&quot;</span>)</span>
<span id="cb1-119"><a href="r-code.html#cb1-119"></a><span class="kw">pltSubjectStatByPool</span>(<span class="st">&quot;overallPhi&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Overdispersion (phi)&quot;</span>)</span>
<span id="cb1-120"><a href="r-code.html#cb1-120"></a><span class="kw">setkey</span>(subjectMeta, subject)</span>
<span id="cb1-121"><a href="r-code.html#cb1-121"></a><span class="kw">data</span>(subjectCorr)</span>
<span id="cb1-122"><a href="r-code.html#cb1-122"></a><span class="kw">setkey</span>(subjectCorr, subject)</span>
<span id="cb1-123"><a href="r-code.html#cb1-123"></a>subjectCorr &lt;-<span class="st"> </span>subjectMeta[subjectCorr]</span>
<span id="cb1-124"><a href="r-code.html#cb1-124"></a><span class="kw">data</span>(simRes)</span>
<span id="cb1-125"><a href="r-code.html#cb1-125"></a>procSimRes &lt;-<span class="st"> </span><span class="kw">lapply</span>(simRes, <span class="cf">function</span>(x) <span class="kw">procRes</span>(x<span class="op">$</span>clpRes))</span>
<span id="cb1-126"><a href="r-code.html#cb1-126"></a></span>
<span id="cb1-127"><a href="r-code.html#cb1-127"></a>simResTbl &lt;-<span class="st"> </span><span class="kw">lapply</span>(procSimRes,</span>
<span id="cb1-128"><a href="r-code.html#cb1-128"></a>                    <span class="cf">function</span>(x) x<span class="op">$</span>mnDat[ , .(mcc, tpr, fdr), <span class="dt">keyby =</span> dep])</span>
<span id="cb1-129"><a href="r-code.html#cb1-129"></a>simResTbl &lt;-<span class="st"> </span><span class="kw">Reduce</span>(merge, simResTbl)</span>
<span id="cb1-130"><a href="r-code.html#cb1-130"></a><span class="kw">setnames</span>(simResTbl,</span>
<span id="cb1-131"><a href="r-code.html#cb1-131"></a>         <span class="kw">c</span>(<span class="st">&quot;dep&quot;</span>,</span>
<span id="cb1-132"><a href="r-code.html#cb1-132"></a>           <span class="st">&quot;mcMCC&quot;</span>, <span class="st">&quot;mcTPR&quot;</span>, <span class="st">&quot;mcFDR&quot;</span>,  <span class="co">## mcCNV</span></span>
<span id="cb1-133"><a href="r-code.html#cb1-133"></a>           <span class="st">&quot;edMCC&quot;</span>, <span class="st">&quot;edTPR&quot;</span>, <span class="st">&quot;edFDR&quot;</span>,  <span class="co">## ExomeDepthDefault</span></span>
<span id="cb1-134"><a href="r-code.html#cb1-134"></a>           <span class="st">&quot;ebMCC&quot;</span>, <span class="st">&quot;ebTPR&quot;</span>, <span class="st">&quot;ebFDR&quot;</span>)) <span class="co">## ExomeDepthBest</span></span>
<span id="cb1-135"><a href="r-code.html#cb1-135"></a><span class="kw">setcolorder</span>(simResTbl,</span>
<span id="cb1-136"><a href="r-code.html#cb1-136"></a>            <span class="kw">c</span>(<span class="st">&quot;dep&quot;</span>, <span class="st">&quot;mcMCC&quot;</span>, <span class="st">&quot;edMCC&quot;</span>, <span class="st">&quot;ebMCC&quot;</span>, <span class="st">&quot;mcTPR&quot;</span>,</span>
<span id="cb1-137"><a href="r-code.html#cb1-137"></a>              <span class="st">&quot;edTPR&quot;</span>, <span class="st">&quot;ebTPR&quot;</span>, <span class="st">&quot;mcFDR&quot;</span>, <span class="st">&quot;edFDR&quot;</span>, <span class="st">&quot;ebFDR&quot;</span>))</span>
<span id="cb1-138"><a href="r-code.html#cb1-138"></a>simResTbl &lt;-<span class="st"> </span>simResTbl[ , <span class="kw">lapply</span>(.SD, signif, <span class="dv">3</span>), by =<span class="st"> </span>dep]</span>
<span id="cb1-139"><a href="r-code.html#cb1-139"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthDefault, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-140"><a href="r-code.html#cb1-140"></a>               <span class="dt">stat =</span> <span class="st">&quot;mcc&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-141"><a href="r-code.html#cb1-141"></a><span class="kw">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-142"><a href="r-code.html#cb1-142"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthDefault, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-143"><a href="r-code.html#cb1-143"></a>               <span class="dt">stat =</span> <span class="st">&quot;tpr&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-144"><a href="r-code.html#cb1-144"></a><span class="kw">addfiglab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-145"><a href="r-code.html#cb1-145"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthDefault, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-146"><a href="r-code.html#cb1-146"></a>               <span class="dt">stat =</span> <span class="st">&quot;fdr&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-147"><a href="r-code.html#cb1-147"></a><span class="kw">addfiglab</span>(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-148"><a href="r-code.html#cb1-148"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthBest, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-149"><a href="r-code.html#cb1-149"></a>               <span class="dt">stat =</span> <span class="st">&quot;mcc&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-150"><a href="r-code.html#cb1-150"></a><span class="kw">addfiglab</span>(<span class="st">&quot;D&quot;</span>)</span>
<span id="cb1-151"><a href="r-code.html#cb1-151"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthBest, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-152"><a href="r-code.html#cb1-152"></a>               <span class="dt">stat =</span> <span class="st">&quot;tpr&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-153"><a href="r-code.html#cb1-153"></a><span class="kw">addfiglab</span>(<span class="st">&quot;E&quot;</span>)</span>
<span id="cb1-154"><a href="r-code.html#cb1-154"></a><span class="kw">pltStatCompare</span>(<span class="dt">xRes =</span> procSimRes<span class="op">$</span>ExomeDepthBest, <span class="dt">yRes =</span> procSimRes<span class="op">$</span>mcCNV,</span>
<span id="cb1-155"><a href="r-code.html#cb1-155"></a>               <span class="dt">stat =</span> <span class="st">&quot;fdr&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-156"><a href="r-code.html#cb1-156"></a><span class="kw">addfiglab</span>(<span class="st">&quot;F&quot;</span>)</span>
<span id="cb1-157"><a href="r-code.html#cb1-157"></a><span class="kw">kable</span>(simResTbl,</span>
<span id="cb1-158"><a href="r-code.html#cb1-158"></a>      <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;dep&quot;</span>, <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;mcCNV&quot;</span>, <span class="st">&quot;ED-def&quot;</span>, <span class="st">&quot;ED-sim&quot;</span>), <span class="dv">3</span>)),</span>
<span id="cb1-159"><a href="r-code.html#cb1-159"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>, </span>
<span id="cb1-160"><a href="r-code.html#cb1-160"></a>      <span class="dt">caption =</span> <span class="st">&#39;Simulation results by algorithm. ED-def: ExomeDepth with default parameters; ED-sim: ExomeDepth with simulation-matched parameters. Values represent the mean over 200 simulations.&#39;</span>,</span>
<span id="cb1-161"><a href="r-code.html#cb1-161"></a>      <span class="dt">label =</span> <span class="st">&quot;simResTbl&quot;</span>,</span>
<span id="cb1-162"><a href="r-code.html#cb1-162"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-163"><a href="r-code.html#cb1-163"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-164"><a href="r-code.html#cb1-164"></a>      <span class="dt">caption.short =</span> <span class="st">&#39;Algorithm performance comparing mcCNV and ExomeDepth on simulated exomes.&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-165"><a href="r-code.html#cb1-165"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-166"><a href="r-code.html#cb1-166"></a><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot; &quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;MCC&quot;</span> =<span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;TPR&quot;</span> =<span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;FDR&quot;</span> =<span class="st"> </span><span class="dv">3</span>))</span>
<span id="cb1-167"><a href="r-code.html#cb1-167"></a><span class="kw">data</span>(wgsPoolCalls)</span>
<span id="cb1-168"><a href="r-code.html#cb1-168"></a>mergeAll &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) <span class="kw">merge</span>(x, y, <span class="dt">all =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-169"><a href="r-code.html#cb1-169"></a>wgs &lt;-<span class="st"> </span><span class="kw">Reduce</span>(mergeAll, wgsPoolCalls)</span>
<span id="cb1-170"><a href="r-code.html#cb1-170"></a><span class="kw">data</span>(intAgl)</span>
<span id="cb1-171"><a href="r-code.html#cb1-171"></a>xpandInt &lt;-<span class="st"> </span><span class="cf">function</span>(int, sbjVec) {</span>
<span id="cb1-172"><a href="r-code.html#cb1-172"></a>  lst &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(sbjVec))</span>
<span id="cb1-173"><a href="r-code.html#cb1-173"></a>  <span class="kw">names</span>(lst) &lt;-<span class="st"> </span>sbjVec</span>
<span id="cb1-174"><a href="r-code.html#cb1-174"></a>  <span class="cf">for</span> (s <span class="cf">in</span> sbjVec) {</span>
<span id="cb1-175"><a href="r-code.html#cb1-175"></a>    lst[[s]] &lt;-<span class="st"> </span><span class="kw">copy</span>(int)</span>
<span id="cb1-176"><a href="r-code.html#cb1-176"></a>    lst[[s]][ , subject <span class="op">:</span><span class="er">=</span><span class="st"> </span>s]</span>
<span id="cb1-177"><a href="r-code.html#cb1-177"></a>  }</span>
<span id="cb1-178"><a href="r-code.html#cb1-178"></a>  <span class="kw">rbindlist</span>(lst)</span>
<span id="cb1-179"><a href="r-code.html#cb1-179"></a>}</span>
<span id="cb1-180"><a href="r-code.html#cb1-180"></a>wgsAgl &lt;-<span class="st"> </span><span class="kw">xpandInt</span>(intAgl, wgs[ , <span class="kw">unique</span>(subject)])</span>
<span id="cb1-181"><a href="r-code.html#cb1-181"></a><span class="kw">setkeyv</span>(wgsAgl, <span class="kw">key</span>(wgs))</span>
<span id="cb1-182"><a href="r-code.html#cb1-182"></a>wgs &lt;-<span class="st"> </span>wgs[wgsAgl]</span>
<span id="cb1-183"><a href="r-code.html#cb1-183"></a><span class="kw">rm</span>(wgsAgl)</span>
<span id="cb1-184"><a href="r-code.html#cb1-184"></a>wgs &lt;-<span class="st"> </span>wgs[<span class="op">!</span>(rlcr),</span>
<span id="cb1-185"><a href="r-code.html#cb1-185"></a>           .(<span class="dt">mcDup =</span> <span class="op">!</span><span class="kw">is.na</span>(passFilter) <span class="op">&amp;</span><span class="st"> </span>CN <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb1-186"><a href="r-code.html#cb1-186"></a>             <span class="dt">edDup =</span> <span class="op">!</span><span class="kw">is.na</span>(type) <span class="op">&amp;</span><span class="st"> </span>type <span class="op">==</span><span class="st"> &quot;duplication&quot;</span>,</span>
<span id="cb1-187"><a href="r-code.html#cb1-187"></a>             <span class="dt">wgDup =</span> <span class="op">!</span><span class="kw">is.na</span>(erds) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(cnvpytor) <span class="op">&amp;</span><span class="st"> </span>erds <span class="op">==</span><span class="st"> &quot;dup&quot;</span>,</span>
<span id="cb1-188"><a href="r-code.html#cb1-188"></a>             <span class="dt">mcDel =</span> <span class="op">!</span><span class="kw">is.na</span>(passFilter) <span class="op">&amp;</span><span class="st"> </span>CN <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb1-189"><a href="r-code.html#cb1-189"></a>             <span class="dt">edDel =</span> <span class="op">!</span><span class="kw">is.na</span>(type) <span class="op">&amp;</span><span class="st"> </span>type <span class="op">==</span><span class="st"> &quot;deletion&quot;</span>,</span>
<span id="cb1-190"><a href="r-code.html#cb1-190"></a>             <span class="dt">wgDel =</span> <span class="op">!</span><span class="kw">is.na</span>(erds) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(cnvpytor) <span class="op">&amp;</span><span class="st"> </span>erds <span class="op">==</span><span class="st"> &quot;del&quot;</span>),</span>
<span id="cb1-191"><a href="r-code.html#cb1-191"></a>           by =<span class="st"> </span>.(subject, seqnames, start, end)]</span>
<span id="cb1-192"><a href="r-code.html#cb1-192"></a>wgs[ , mc <span class="op">:</span><span class="er">=</span><span class="st"> </span>mcDup <span class="op">|</span><span class="st"> </span>mcDel]</span>
<span id="cb1-193"><a href="r-code.html#cb1-193"></a>wgs[ , ed <span class="op">:</span><span class="er">=</span><span class="st"> </span>edDup <span class="op">|</span><span class="st"> </span>edDel]</span>
<span id="cb1-194"><a href="r-code.html#cb1-194"></a>wgs[ , wg <span class="op">:</span><span class="er">=</span><span class="st"> </span>wgDup <span class="op">|</span><span class="st"> </span>wgDel]</span>
<span id="cb1-195"><a href="r-code.html#cb1-195"></a><span class="kw">setcolorder</span>(wgs, <span class="kw">c</span>(<span class="kw">key</span>(wgs), <span class="st">&#39;mc&#39;</span>, <span class="st">&#39;ed&#39;</span>, <span class="st">&#39;wg&#39;</span>))</span>
<span id="cb1-196"><a href="r-code.html#cb1-196"></a>wgsCallBySbj &lt;-<span class="st"> </span>wgs[ , <span class="kw">lapply</span>(.SD, sum), .SDcols =<span class="st"> </span>is.logical, by =<span class="st"> </span>subject]</span>
<span id="cb1-197"><a href="r-code.html#cb1-197"></a><span class="kw">kable</span>(wgsCallBySbj,</span>
<span id="cb1-198"><a href="r-code.html#cb1-198"></a>      <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;ED&quot;</span>, <span class="st">&quot;WG&quot;</span>), <span class="dv">3</span>)),</span>
<span id="cb1-199"><a href="r-code.html#cb1-199"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>, </span>
<span id="cb1-200"><a href="r-code.html#cb1-200"></a>      <span class="dt">caption =</span> <span class="st">&#39;Number of CNV calls by subject and algorithm for the ‘WGS’ pool. ‘MC’ indicates the mcCNV algorithm; ‘ED’ indicates the ExomeDepth algorithm; ‘WG’ indicates the overlap of ERDS/cnvpytor calls from matched whole-genome sequencing. Exons with any overlap of the repetitive and low-complexity regions, as defined in the Trost et al. manuscript,<span class="citation"><sup><a href="references.html#ref-trost:2018aa" role="doc-biblioref">98</a></sup></span> omitted from analysis.&#39;</span>,</span>
<span id="cb1-201"><a href="r-code.html#cb1-201"></a>      <span class="dt">label =</span> <span class="st">&quot;wgsCallSbj&quot;</span>,</span>
<span id="cb1-202"><a href="r-code.html#cb1-202"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-203"><a href="r-code.html#cb1-203"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-204"><a href="r-code.html#cb1-204"></a>      <span class="dt">caption.short =</span> <span class="st">&quot;Number of CNV calls by subject and algorithm for the &#39;WGS&#39; pool.&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-205"><a href="r-code.html#cb1-205"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-206"><a href="r-code.html#cb1-206"></a><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot; &quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Total&quot;</span> =<span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;Duplications&quot;</span> =<span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;Deletions&quot;</span> =<span class="st"> </span><span class="dv">3</span>))</span>
<span id="cb1-207"><a href="r-code.html#cb1-207"></a>pmLst &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb1-208"><a href="r-code.html#cb1-208"></a>pmLst<span class="op">$</span>mc &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(mc, wg))</span>
<span id="cb1-209"><a href="r-code.html#cb1-209"></a>pmLst<span class="op">$</span>ed &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(ed, wg))</span>
<span id="cb1-210"><a href="r-code.html#cb1-210"></a>pmLst<span class="op">$</span>mcSub &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)], <span class="kw">evalPred</span>(mc, wg))</span>
<span id="cb1-211"><a href="r-code.html#cb1-211"></a>pmLst<span class="op">$</span>edSub &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)], <span class="kw">evalPred</span>(ed, wg))</span>
<span id="cb1-212"><a href="r-code.html#cb1-212"></a>pmLst<span class="op">$</span>mcDup &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(mcDup, wgDup))</span>
<span id="cb1-213"><a href="r-code.html#cb1-213"></a>pmLst<span class="op">$</span>edDup &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(edDup, wgDup))</span>
<span id="cb1-214"><a href="r-code.html#cb1-214"></a>pmLst<span class="op">$</span>mcSubDup &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-215"><a href="r-code.html#cb1-215"></a>                       <span class="kw">evalPred</span>(mcDup, wgDup))</span>
<span id="cb1-216"><a href="r-code.html#cb1-216"></a>pmLst<span class="op">$</span>edSubDup &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-217"><a href="r-code.html#cb1-217"></a>                       <span class="kw">evalPred</span>(edDup, wgDup))</span>
<span id="cb1-218"><a href="r-code.html#cb1-218"></a>pmLst<span class="op">$</span>mcDel &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(mcDel, wgDel))</span>
<span id="cb1-219"><a href="r-code.html#cb1-219"></a>pmLst<span class="op">$</span>edDel &lt;-<span class="st"> </span><span class="kw">with</span>(wgs, <span class="kw">evalPred</span>(edDel, wgDel))</span>
<span id="cb1-220"><a href="r-code.html#cb1-220"></a>pmLst<span class="op">$</span>mcSubDel &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-221"><a href="r-code.html#cb1-221"></a>                       <span class="kw">evalPred</span>(mcDel, wgDel))</span>
<span id="cb1-222"><a href="r-code.html#cb1-222"></a>pmLst<span class="op">$</span>edSubDel &lt;-<span class="st"> </span><span class="kw">with</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-223"><a href="r-code.html#cb1-223"></a>                       <span class="kw">evalPred</span>(edDel, wgDel))</span>
<span id="cb1-224"><a href="r-code.html#cb1-224"></a>predMetrics &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(<span class="kw">do.call</span>(rbind, pmLst), <span class="dt">keep.rownames =</span> <span class="st">&quot;PredSet&quot;</span>)</span>
<span id="cb1-225"><a href="r-code.html#cb1-225"></a>predMetrics[ , typ <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;ALL&quot;</span>, <span class="st">&quot;DUP&quot;</span>, <span class="st">&quot;DEL&quot;</span>), <span class="dt">each =</span> <span class="dv">4</span>)]</span>
<span id="cb1-226"><a href="r-code.html#cb1-226"></a>predMetrics[ , set <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;Sub&quot;</span>, PredSet), <span class="st">&quot;Sub&quot;</span>, <span class="st">&quot;Total&quot;</span>)]</span>
<span id="cb1-227"><a href="r-code.html#cb1-227"></a>predMetrics[ , alg <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">&quot;mc&quot;</span>, PredSet), <span class="st">&quot;MC&quot;</span>, <span class="st">&quot;ED&quot;</span>)]</span>
<span id="cb1-228"><a href="r-code.html#cb1-228"></a><span class="kw">setcolorder</span>(predMetrics, <span class="kw">c</span>(<span class="st">&quot;typ&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;alg&quot;</span>))</span>
<span id="cb1-229"><a href="r-code.html#cb1-229"></a><span class="kw">kable</span>(predMetrics[ , .(typ, set, alg, MCC, TPR, FDR, PPV)],</span>
<span id="cb1-230"><a href="r-code.html#cb1-230"></a>      <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;MCC&quot;</span>, <span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;PPV&quot;</span>),</span>
<span id="cb1-231"><a href="r-code.html#cb1-231"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>, </span>
<span id="cb1-232"><a href="r-code.html#cb1-232"></a>      <span class="dt">caption =</span> <span class="st">&#39;mcCNV (MC)/ExomeDepth (ED) calls for ‘WGS’ pool (used as prediction) versus the ERDS/cnvpytor calls from matched genome sequencing (used as truth). Calls are subdivided by duplications (DUP) and deletions (DEL). ‘Full’ gives performance across the full pool; ‘Sub’ gives the performance excluding the poorly correlated samples NCG_00790 and NCG_00851 (gray rows). ‘MCC’ is Matthew’s correlation coefficient, ‘TPR’ is true positive rate/sensitivity, ‘FDR’ is false discovery rate, ‘PPV’ is positive predictive value, ‘BalAcc’ is balanced accuracy. Exons with any overlap of the repetitive and low-complexity regions, as defined in the Trost et al. manuscript,<span class="citation"><sup><a href="references.html#ref-trost:2018aa" role="doc-biblioref">98</a></sup></span> omitted from analysis.&#39;</span>,</span>
<span id="cb1-233"><a href="r-code.html#cb1-233"></a>      <span class="dt">label =</span> <span class="st">&quot;predMet&quot;</span>,</span>
<span id="cb1-234"><a href="r-code.html#cb1-234"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-235"><a href="r-code.html#cb1-235"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-236"><a href="r-code.html#cb1-236"></a>      <span class="dt">caption.short =</span> <span class="st">&quot;mcCNV and ExomeDepth performance predicting calls from genome sequencing.&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-237"><a href="r-code.html#cb1-237"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-238"><a href="r-code.html#cb1-238"></a><span class="st">  </span><span class="kw">collapse_rows</span>(<span class="dt">columns =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">valign =</span> <span class="st">&quot;middle&quot;</span>)</span>
<span id="cb1-239"><a href="r-code.html#cb1-239"></a>ctsAll &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[ , .(mc, ed, wg)])</span>
<span id="cb1-240"><a href="r-code.html#cb1-240"></a>ctsSub &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mc, ed, wg)])</span>
<span id="cb1-241"><a href="r-code.html#cb1-241"></a>ctsAllDup &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[ , .(mcDup, edDup, wgDup)])</span>
<span id="cb1-242"><a href="r-code.html#cb1-242"></a>ctsSubDup &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mcDup, edDup, wgDup)])</span>
<span id="cb1-243"><a href="r-code.html#cb1-243"></a>ctsAllDel &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[ , .(mcDel, edDel, wgDel)])</span>
<span id="cb1-244"><a href="r-code.html#cb1-244"></a>ctsSubDel &lt;-<span class="st"> </span><span class="kw">euler</span>(wgs[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mcDel, edDel, wgDel)])</span>
<span id="cb1-245"><a href="r-code.html#cb1-245"></a><span class="kw">eulerr_options</span>(<span class="dt">fills =</span> <span class="kw">list</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-246"><a href="r-code.html#cb1-246"></a>               <span class="dt">quantities =</span> <span class="kw">list</span>(<span class="dt">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-247"><a href="r-code.html#cb1-247"></a>gridFigLab &lt;-<span class="st"> </span><span class="cf">function</span>(lab) {</span>
<span id="cb1-248"><a href="r-code.html#cb1-248"></a>  <span class="kw">grid.text</span>(lab, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">1</span>, <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">font =</span> <span class="dv">2</span>))</span>
<span id="cb1-249"><a href="r-code.html#cb1-249"></a>}</span>
<span id="cb1-250"><a href="r-code.html#cb1-250"></a><span class="kw">eulerr_options</span>(<span class="dt">fills =</span> <span class="kw">list</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-251"><a href="r-code.html#cb1-251"></a>               <span class="dt">quantities =</span> <span class="kw">list</span>(<span class="dt">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-252"><a href="r-code.html#cb1-252"></a><span class="kw">plot</span>(ctsAllDup, <span class="dt">quantities =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-253"><a href="r-code.html#cb1-253"></a><span class="kw">gridFigLab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-254"><a href="r-code.html#cb1-254"></a><span class="kw">grid.text</span>(<span class="st">&quot;DUPLICATIONS&quot;</span>, <span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-255"><a href="r-code.html#cb1-255"></a><span class="kw">plot</span>(ctsAllDel, <span class="dt">quantities =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-256"><a href="r-code.html#cb1-256"></a><span class="kw">gridFigLab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-257"><a href="r-code.html#cb1-257"></a><span class="kw">grid.text</span>(<span class="st">&quot;DELETIONS&quot;</span>, <span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-258"><a href="r-code.html#cb1-258"></a></span>
<span id="cb1-259"><a href="r-code.html#cb1-259"></a><span class="kw">eulerr_options</span>(<span class="dt">fills =</span> <span class="kw">list</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-260"><a href="r-code.html#cb1-260"></a>               <span class="dt">quantities =</span> <span class="kw">list</span>(<span class="dt">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-261"><a href="r-code.html#cb1-261"></a><span class="kw">plot</span>(ctsSubDup, <span class="dt">quantities =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-262"><a href="r-code.html#cb1-262"></a><span class="kw">gridFigLab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-263"><a href="r-code.html#cb1-263"></a><span class="kw">grid.text</span>(<span class="st">&quot;DUPLICATIONS&quot;</span>, <span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-264"><a href="r-code.html#cb1-264"></a><span class="kw">plot</span>(ctsSubDel, <span class="dt">quantities =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-265"><a href="r-code.html#cb1-265"></a><span class="kw">gridFigLab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-266"><a href="r-code.html#cb1-266"></a><span class="kw">grid.text</span>(<span class="st">&quot;DELETIONS&quot;</span>, <span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-267"><a href="r-code.html#cb1-267"></a><span class="co">## Estimate maternal-fetal genotypes from cell-free exome sequencing</span></span>
<span id="cb1-268"><a href="r-code.html#cb1-268"></a><span class="kw">data</span>(gt)</span>
<span id="cb1-269"><a href="r-code.html#cb1-269"></a>gt[ , udep <span class="op">:</span><span class="er">=</span><span class="st"> </span>ref <span class="op">+</span><span class="st"> </span>alt]</span>
<span id="cb1-270"><a href="r-code.html#cb1-270"></a>gt[ , use <span class="op">:</span><span class="er">=</span><span class="st"> </span>udep <span class="op">&gt;</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>ref <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>alt <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>]</span>
<span id="cb1-271"><a href="r-code.html#cb1-271"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;S1&quot;</span>, <span class="st">&quot;S2&quot;</span>, <span class="st">&quot;FES-0034-4&quot;</span>)) {</span>
<span id="cb1-272"><a href="r-code.html#cb1-272"></a>  gt[smp <span class="op">==</span><span class="st"> </span>s <span class="op">&amp;</span><span class="st"> </span>use,</span>
<span id="cb1-273"><a href="r-code.html#cb1-273"></a>     <span class="kw">c</span>(<span class="st">&quot;ff&quot;</span>, <span class="st">&quot;gtCall&quot;</span>, <span class="st">&quot;gtLike&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">callSmpl</span>(alt, udep, .N, <span class="kw">median</span>(sdep<span class="op">/</span>ldep))]</span>
<span id="cb1-274"><a href="r-code.html#cb1-274"></a>}</span>
<span id="cb1-275"><a href="r-code.html#cb1-275"></a><span class="co">## Calculate median read depth &amp; fetal fraction estimates by sample</span></span>
<span id="cb1-276"><a href="r-code.html#cb1-276"></a>smry &lt;-<span class="st"> </span>gt[(use), .(<span class="dt">md =</span> <span class="kw">median</span>(udep), <span class="dt">ff =</span> ff[<span class="dv">1</span>]), by =<span class="st"> </span>smp]</span>
<span id="cb1-277"><a href="r-code.html#cb1-277"></a><span class="kw">setkey</span>(smry, smp)</span>
<span id="cb1-278"><a href="r-code.html#cb1-278"></a><span class="co">## Allele depth histograms</span></span>
<span id="cb1-279"><a href="r-code.html#cb1-279"></a><span class="co"># par(oma = c(3, 0, 0, 0), mfrow = c(3, 1))</span></span>
<span id="cb1-280"><a href="r-code.html#cb1-280"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">1</span>), <span class="dt">heights =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>), <span class="dv">1</span>))</span>
<span id="cb1-281"><a href="r-code.html#cb1-281"></a><span class="kw">with</span>(gt[use <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> &quot;S1&quot;</span>], <span class="kw">cfPltFreqHist</span>(alt, udep, gtCall, <span class="dt">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-282"><a href="r-code.html#cb1-282"></a><span class="kw">title</span>(<span class="dt">ylab =</span> <span class="st">&quot;Case 1&quot;</span>, <span class="dt">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-283"><a href="r-code.html#cb1-283"></a><span class="kw">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-284"><a href="r-code.html#cb1-284"></a></span>
<span id="cb1-285"><a href="r-code.html#cb1-285"></a><span class="kw">data</span>(rs140468248)</span>
<span id="cb1-286"><a href="r-code.html#cb1-286"></a><span class="kw">data</span>(GenoMeta)</span>
<span id="cb1-287"><a href="r-code.html#cb1-287"></a><span class="kw">with</span>(gt[use <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> &quot;S2&quot;</span>], <span class="kw">cfPltFreqHist</span>(alt, udep, gtCall, <span class="dt">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-288"><a href="r-code.html#cb1-288"></a>oiCall &lt;-<span class="st"> </span>gt[varid <span class="op">==</span><span class="st"> </span>rs140468248, gtCall]</span>
<span id="cb1-289"><a href="r-code.html#cb1-289"></a>oiPmar &lt;-<span class="st"> </span>gt[varid <span class="op">==</span><span class="st"> </span>rs140468248, alt<span class="op">/</span>(ref <span class="op">+</span><span class="st"> </span>alt)]</span>
<span id="cb1-290"><a href="r-code.html#cb1-290"></a><span class="kw">abline</span>(<span class="dt">v =</span> oiPmar, <span class="dt">col =</span> GenoMeta<span class="op">$</span>color[GenoMeta<span class="op">$</span>name <span class="op">==</span><span class="st"> </span>oiCall])</span>
<span id="cb1-291"><a href="r-code.html#cb1-291"></a><span class="kw">text</span>(<span class="dt">x =</span> oiPmar,</span>
<span id="cb1-292"><a href="r-code.html#cb1-292"></a>     <span class="dt">y =</span> <span class="kw">grconvertY</span>(<span class="fl">0.75</span>, <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-293"><a href="r-code.html#cb1-293"></a>     <span class="st">&quot;rs140468248&quot;</span>,</span>
<span id="cb1-294"><a href="r-code.html#cb1-294"></a>     <span class="dt">srt =</span> <span class="dv">90</span>,</span>
<span id="cb1-295"><a href="r-code.html#cb1-295"></a>     <span class="dt">adj =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb1-296"><a href="r-code.html#cb1-296"></a>     <span class="dt">col =</span> GenoMeta<span class="op">$</span>color[GenoMeta<span class="op">$</span>name <span class="op">==</span><span class="st"> </span>oiCall])</span>
<span id="cb1-297"><a href="r-code.html#cb1-297"></a><span class="kw">title</span>(<span class="dt">ylab =</span> <span class="st">&quot;Case 2&quot;</span>, <span class="dt">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-298"><a href="r-code.html#cb1-298"></a><span class="kw">addfiglab</span>(<span class="st">&quot;B&quot;</span>, <span class="dt">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-299"><a href="r-code.html#cb1-299"></a></span>
<span id="cb1-300"><a href="r-code.html#cb1-300"></a><span class="kw">with</span>(gt[use <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> &quot;FES-0034-4&quot;</span>], <span class="kw">cfPltFreqHist</span>(alt, udep, gtCall, <span class="dt">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-301"><a href="r-code.html#cb1-301"></a><span class="kw">title</span>(<span class="dt">ylab =</span> <span class="st">&quot;Case 3&quot;</span>, <span class="dt">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-302"><a href="r-code.html#cb1-302"></a><span class="kw">addfiglab</span>(<span class="st">&quot;C&quot;</span>, <span class="dt">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-303"><a href="r-code.html#cb1-303"></a></span>
<span id="cb1-304"><a href="r-code.html#cb1-304"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb1-305"><a href="r-code.html#cb1-305"></a><span class="kw">plot.new</span>()</span>
<span id="cb1-306"><a href="r-code.html#cb1-306"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="kw">grconvertX</span>(<span class="fl">0.5</span>, <span class="dt">from =</span> <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-307"><a href="r-code.html#cb1-307"></a>       <span class="dt">y =</span> <span class="kw">grconvertY</span>(<span class="fl">0.5</span>, <span class="dt">from =</span> <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-308"><a href="r-code.html#cb1-308"></a>       <span class="dt">legend =</span> GenoMeta<span class="op">$</span>name,</span>
<span id="cb1-309"><a href="r-code.html#cb1-309"></a>       <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-310"><a href="r-code.html#cb1-310"></a>       <span class="dt">lwd =</span> <span class="dv">4</span>,</span>
<span id="cb1-311"><a href="r-code.html#cb1-311"></a>       <span class="dt">col =</span> GenoMeta<span class="op">$</span>color,</span>
<span id="cb1-312"><a href="r-code.html#cb1-312"></a>       <span class="dt">xjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-313"><a href="r-code.html#cb1-313"></a>       <span class="dt">yjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-314"><a href="r-code.html#cb1-314"></a>       <span class="dt">xpd =</span> <span class="ot">NA</span>,</span>
<span id="cb1-315"><a href="r-code.html#cb1-315"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-316"><a href="r-code.html#cb1-316"></a><span class="co">## Collect read depth and filtering information into a table</span></span>
<span id="cb1-317"><a href="r-code.html#cb1-317"></a><span class="kw">data</span>(readSmry)</span>
<span id="cb1-318"><a href="r-code.html#cb1-318"></a>rs &lt;-<span class="st"> </span>readSmry<span class="op">$</span>summary</span>
<span id="cb1-319"><a href="r-code.html#cb1-319"></a>rs[ , pctDup <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">round</span>(pctDup, <span class="dv">2</span>)]</span>
<span id="cb1-320"><a href="r-code.html#cb1-320"></a>rs[ , pctFlt <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">round</span>(pctFlt, <span class="dv">2</span>)]</span>
<span id="cb1-321"><a href="r-code.html#cb1-321"></a><span class="kw">setkey</span>(rs, smp)</span>
<span id="cb1-322"><a href="r-code.html#cb1-322"></a>rs &lt;-<span class="st"> </span>smry[rs]</span>
<span id="cb1-323"><a href="r-code.html#cb1-323"></a>rs[ , ff <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">round</span>(ff, <span class="dv">3</span>)]</span>
<span id="cb1-324"><a href="r-code.html#cb1-324"></a>rs[smp <span class="op">==</span><span class="st"> &quot;S1&quot;</span>, case <span class="op">:</span><span class="er">=</span><span class="st"> &quot;Case 1&quot;</span>]</span>
<span id="cb1-325"><a href="r-code.html#cb1-325"></a>rs[smp <span class="op">==</span><span class="st"> &quot;S2&quot;</span>, case <span class="op">:</span><span class="er">=</span><span class="st"> &quot;Case 2&quot;</span>]</span>
<span id="cb1-326"><a href="r-code.html#cb1-326"></a>rs[<span class="kw">grepl</span>(<span class="st">&quot;FES&quot;</span>, smp), case <span class="op">:</span><span class="er">=</span><span class="st"> &quot;Case 3&quot;</span>]</span>
<span id="cb1-327"><a href="r-code.html#cb1-327"></a>caseSmry &lt;-<span class="st"> </span>rs[<span class="op">!</span><span class="kw">is.na</span>(ff)][<span class="kw">order</span>(case)][ , {</span>
<span id="cb1-328"><a href="r-code.html#cb1-328"></a>  .(<span class="dt">GA =</span> <span class="kw">sprintf</span>(<span class="st">&#39;(ref:case%dga)&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</span>
<span id="cb1-329"><a href="r-code.html#cb1-329"></a>    <span class="st">`</span><span class="dt">Clinical findings</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;(ref:case%dcc)&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</span>
<span id="cb1-330"><a href="r-code.html#cb1-330"></a>    <span class="st">`</span><span class="dt">Genetic diagnosis</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;(ref:case%dgd)&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),</span>
<span id="cb1-331"><a href="r-code.html#cb1-331"></a>    <span class="dt">FF =</span> ff, </span>
<span id="cb1-332"><a href="r-code.html#cb1-332"></a>    <span class="dt">Dep =</span> md, </span>
<span id="cb1-333"><a href="r-code.html#cb1-333"></a>    <span class="st">`</span><span class="dt">%Dup</span><span class="st">`</span> =<span class="st"> </span>pctDup, </span>
<span id="cb1-334"><a href="r-code.html#cb1-334"></a>    <span class="st">`</span><span class="dt">%Filt</span><span class="st">`</span> =<span class="st"> </span>pctFlt)</span>
<span id="cb1-335"><a href="r-code.html#cb1-335"></a>}]</span>
<span id="cb1-336"><a href="r-code.html#cb1-336"></a><span class="kw">kable</span>(caseSmry, </span>
<span id="cb1-337"><a href="r-code.html#cb1-337"></a>      <span class="dt">row.names =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-338"><a href="r-code.html#cb1-338"></a>      <span class="dt">caption =</span> <span class="st">&#39;Case summaries. GA: gestational age at the time of blood draw for cfES. FF: estimated fetal fraction. Depth: median depth used to estimate genotypes (does not include duplicated/filtered reads). %Dup: percentage of total mapped read pairs discarded as PCR and/or optical duplicates. %Filt: percentage of total mapped read pairs discarded for improper pairing and/or mapping quality.&#39;</span>,</span>
<span id="cb1-339"><a href="r-code.html#cb1-339"></a>      <span class="dt">label =</span> <span class="st">&quot;caseSmry&quot;</span>,</span>
<span id="cb1-340"><a href="r-code.html#cb1-340"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-341"><a href="r-code.html#cb1-341"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-342"><a href="r-code.html#cb1-342"></a>      <span class="dt">caption.short =</span> <span class="st">&quot;Cell-free exome sequencing case summaries&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-343"><a href="r-code.html#cb1-343"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-344"><a href="r-code.html#cb1-344"></a><span class="st">  </span><span class="kw">column_spec</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">width =</span> <span class="st">&quot;10em&quot;</span>)</span>
<span id="cb1-345"><a href="r-code.html#cb1-345"></a><span class="co">## Load c3MatFetReads</span></span>
<span id="cb1-346"><a href="r-code.html#cb1-346"></a><span class="kw">data</span>(c3MatFetReads)</span>
<span id="cb1-347"><a href="r-code.html#cb1-347"></a><span class="co">## Calculate density and ECDF for fragment read lengths</span></span>
<span id="cb1-348"><a href="r-code.html#cb1-348"></a>matDen &lt;-<span class="st"> </span><span class="kw">density</span>(c3MatFetReads[source <span class="op">==</span><span class="st"> &quot;maternal&quot;</span>, isize])</span>
<span id="cb1-349"><a href="r-code.html#cb1-349"></a>fetDen &lt;-<span class="st"> </span><span class="kw">density</span>(c3MatFetReads[source <span class="op">==</span><span class="st"> &quot;fetal&quot;</span>,    isize])</span>
<span id="cb1-350"><a href="r-code.html#cb1-350"></a>matCdf &lt;-<span class="st"> </span><span class="kw">ecdf</span>(c3MatFetReads[source <span class="op">==</span><span class="st"> &quot;maternal&quot;</span>, isize])</span>
<span id="cb1-351"><a href="r-code.html#cb1-351"></a>fetCdf &lt;-<span class="st"> </span><span class="kw">ecdf</span>(c3MatFetReads[source <span class="op">==</span><span class="st"> &quot;fetal&quot;</span>,    isize])</span>
<span id="cb1-352"><a href="r-code.html#cb1-352"></a></span>
<span id="cb1-353"><a href="r-code.html#cb1-353"></a><span class="co">## Generate plots</span></span>
<span id="cb1-354"><a href="r-code.html#cb1-354"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb1-355"><a href="r-code.html#cb1-355"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-356"><a href="r-code.html#cb1-356"></a><span class="kw">plot.new</span>()</span>
<span id="cb1-357"><a href="r-code.html#cb1-357"></a><span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(<span class="kw">c</span>(matDen<span class="op">$</span>x, fetDen<span class="op">$</span>x)), <span class="kw">range</span>(<span class="kw">c</span>(matDen<span class="op">$</span>y, fetDen<span class="op">$</span>y)))</span>
<span id="cb1-358"><a href="r-code.html#cb1-358"></a><span class="kw">lines</span>(matDen, <span class="dt">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-359"><a href="r-code.html#cb1-359"></a><span class="kw">lines</span>(fetDen, <span class="dt">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="dt">lwd =</span><span class="dv">2</span>)</span>
<span id="cb1-360"><a href="r-code.html#cb1-360"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>)</span>
<span id="cb1-361"><a href="r-code.html#cb1-361"></a><span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Fragment length (insert size)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb1-362"><a href="r-code.html#cb1-362"></a><span class="kw">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-363"><a href="r-code.html#cb1-363"></a><span class="kw">plot.new</span>()</span>
<span id="cb1-364"><a href="r-code.html#cb1-364"></a>xv &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">300</span>, <span class="dv">1</span>)</span>
<span id="cb1-365"><a href="r-code.html#cb1-365"></a><span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(xv), <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>)</span>
<span id="cb1-366"><a href="r-code.html#cb1-366"></a><span class="kw">points</span>(<span class="dt">x =</span> xv, <span class="dt">y =</span> <span class="kw">matCdf</span>(xv), <span class="dt">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-367"><a href="r-code.html#cb1-367"></a><span class="kw">points</span>(<span class="dt">x =</span> xv, <span class="dt">y =</span> <span class="kw">fetCdf</span>(xv), <span class="dt">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-368"><a href="r-code.html#cb1-368"></a><span class="kw">addfiglab</span>(<span class="st">&quot;B&quot;</span>, <span class="dt">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-369"><a href="r-code.html#cb1-369"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>)</span>
<span id="cb1-370"><a href="r-code.html#cb1-370"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>)</span>
<span id="cb1-371"><a href="r-code.html#cb1-371"></a><span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Fragment length (insert size)&quot;</span>,</span>
<span id="cb1-372"><a href="r-code.html#cb1-372"></a>      <span class="dt">ylab =</span> <span class="st">&quot;Cumulative distribution&quot;</span>)</span>
<span id="cb1-373"><a href="r-code.html#cb1-373"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="kw">grconvertX</span>(<span class="fl">0.5</span>, <span class="dt">from =</span> <span class="st">&quot;ndc&quot;</span>),</span>
<span id="cb1-374"><a href="r-code.html#cb1-374"></a>       <span class="dt">y =</span> <span class="kw">line2user</span>(<span class="dv">2</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>),</span>
<span id="cb1-375"><a href="r-code.html#cb1-375"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Maternal&quot;</span>, <span class="st">&quot;Fetal&quot;</span>),</span>
<span id="cb1-376"><a href="r-code.html#cb1-376"></a>       <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-377"><a href="r-code.html#cb1-377"></a>       <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb1-378"><a href="r-code.html#cb1-378"></a>       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>),</span>
<span id="cb1-379"><a href="r-code.html#cb1-379"></a>       <span class="dt">xjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-380"><a href="r-code.html#cb1-380"></a>       <span class="dt">yjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-381"><a href="r-code.html#cb1-381"></a>       <span class="dt">xpd =</span> <span class="ot">NA</span>,</span>
<span id="cb1-382"><a href="r-code.html#cb1-382"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-383"><a href="r-code.html#cb1-383"></a>gt[ , pmar <span class="op">:</span><span class="er">=</span><span class="st"> </span>alt<span class="op">/</span>(alt <span class="op">+</span><span class="st"> </span>ref)]</span>
<span id="cb1-384"><a href="r-code.html#cb1-384"></a>gt[ , sratio <span class="op">:</span><span class="er">=</span><span class="st"> </span>sdep<span class="op">/</span>adep]</span>
<span id="cb1-385"><a href="r-code.html#cb1-385"></a>pltSratioByPmar &lt;-<span class="st"> </span><span class="cf">function</span>(smpNm) {</span>
<span id="cb1-386"><a href="r-code.html#cb1-386"></a>  <span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-387"><a href="r-code.html#cb1-387"></a>  <span class="kw">with</span>(gt[gtCall <span class="op">==</span><span class="st"> &quot;AAab&quot;</span> <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> </span>smpNm], {</span>
<span id="cb1-388"><a href="r-code.html#cb1-388"></a>    <span class="kw">plot</span>(pmar <span class="op">~</span><span class="st"> </span>sratio,</span>
<span id="cb1-389"><a href="r-code.html#cb1-389"></a>         <span class="dt">xlab =</span> <span class="st">&quot;Proportion of fragments &lt; 140 bp&quot;</span>,</span>
<span id="cb1-390"><a href="r-code.html#cb1-390"></a>         <span class="dt">ylab =</span> <span class="st">&quot;PMAR&quot;</span>,</span>
<span id="cb1-391"><a href="r-code.html#cb1-391"></a>         <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1-392"><a href="r-code.html#cb1-392"></a>         <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-393"><a href="r-code.html#cb1-393"></a>         <span class="dt">col =</span> <span class="kw">col2alpha</span>(<span class="st">&#39;darkgray&#39;</span>),</span>
<span id="cb1-394"><a href="r-code.html#cb1-394"></a>         <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-395"><a href="r-code.html#cb1-395"></a>  })</span>
<span id="cb1-396"><a href="r-code.html#cb1-396"></a>  <span class="kw">with</span>(gt[gtCall <span class="op">==</span><span class="st"> &quot;AAab&quot;</span> <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> </span>smpNm], {</span>
<span id="cb1-397"><a href="r-code.html#cb1-397"></a>    <span class="kw">contour</span>(<span class="kw">kde2d</span>(<span class="dt">x =</span> sratio, <span class="dt">y =</span> pmar, <span class="dt">n =</span> <span class="dv">500</span>),</span>
<span id="cb1-398"><a href="r-code.html#cb1-398"></a>            <span class="dt">nlevels =</span> <span class="dv">25</span>,</span>
<span id="cb1-399"><a href="r-code.html#cb1-399"></a>            <span class="dt">add =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-400"><a href="r-code.html#cb1-400"></a>            <span class="dt">drawlabels =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-401"><a href="r-code.html#cb1-401"></a>            <span class="dt">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb1-402"><a href="r-code.html#cb1-402"></a>  })</span>
<span id="cb1-403"><a href="r-code.html#cb1-403"></a>}</span>
<span id="cb1-404"><a href="r-code.html#cb1-404"></a><span class="kw">pltSratioByPmar</span>(<span class="st">&quot;S1&quot;</span>)</span>
<span id="cb1-405"><a href="r-code.html#cb1-405"></a><span class="kw">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-406"><a href="r-code.html#cb1-406"></a><span class="kw">pltSratioByPmar</span>(<span class="st">&quot;S2&quot;</span>)</span>
<span id="cb1-407"><a href="r-code.html#cb1-407"></a><span class="kw">addfiglab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-408"><a href="r-code.html#cb1-408"></a><span class="kw">pltSratioByPmar</span>(<span class="st">&quot;FES-0034-4&quot;</span>)</span>
<span id="cb1-409"><a href="r-code.html#cb1-409"></a><span class="kw">addfiglab</span>(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-410"><a href="r-code.html#cb1-410"></a><span class="co">## Calculate call concordance between cell-free and direct for Case 3</span></span>
<span id="cb1-411"><a href="r-code.html#cb1-411"></a>c3 &lt;-<span class="st"> </span>gt[(smp <span class="op">==</span><span class="st"> &quot;FES-0034-0&quot;</span> <span class="op">&amp;</span><span class="st"> </span>udep <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>gt <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)) <span class="op">|</span></span>
<span id="cb1-412"><a href="r-code.html#cb1-412"></a><span class="st">           </span>(smp <span class="op">==</span><span class="st"> &quot;FES-0034-1&quot;</span> <span class="op">&amp;</span><span class="st"> </span>udep <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>gt <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)) <span class="op">|</span></span>
<span id="cb1-413"><a href="r-code.html#cb1-413"></a><span class="st">           </span>(use <span class="op">&amp;</span><span class="st"> </span>smp <span class="op">==</span><span class="st"> &quot;FES-0034-4&quot;</span>)]</span>
<span id="cb1-414"><a href="r-code.html#cb1-414"></a>c3[ , mrg <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">substr</span>(gtCall, <span class="dv">3</span>, <span class="dv">4</span>)]</span>
<span id="cb1-415"><a href="r-code.html#cb1-415"></a>c3[ , mrg <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)[<span class="kw">match</span>(mrg, <span class="kw">c</span>(<span class="st">&quot;aa&quot;</span>, <span class="st">&quot;ab&quot;</span>, <span class="st">&quot;bb&quot;</span>))]]</span>
<span id="cb1-416"><a href="r-code.html#cb1-416"></a>c3[<span class="kw">is.na</span>(gtCall), mrg <span class="op">:</span><span class="er">=</span><span class="st"> </span>gt]</span>
<span id="cb1-417"><a href="r-code.html#cb1-417"></a>c3 &lt;-<span class="st"> </span><span class="kw">dcast</span>(c3, varid <span class="op">~</span><span class="st"> </span>smp, <span class="dt">value.var =</span> <span class="st">&quot;mrg&quot;</span>)</span>
<span id="cb1-418"><a href="r-code.html#cb1-418"></a><span class="kw">setnames</span>(c3, <span class="kw">c</span>(<span class="st">&quot;varid&quot;</span>, <span class="st">&quot;fet&quot;</span>, <span class="st">&quot;mat&quot;</span>, <span class="st">&quot;cff&quot;</span>))</span>
<span id="cb1-419"><a href="r-code.html#cb1-419"></a>c3 &lt;-<span class="st"> </span>c3[ , .N, by =<span class="st"> </span>.(mat, fet, cff)]</span>
<span id="cb1-420"><a href="r-code.html#cb1-420"></a><span class="co">## call by call matrix, cell-free calls in columns, fetal in rows</span></span>
<span id="cb1-421"><a href="r-code.html#cb1-421"></a>c3FetByCf &lt;-<span class="st"> </span><span class="kw">dcast</span>(c3[<span class="op">!</span><span class="kw">is.na</span>(fet) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(cff)], </span>
<span id="cb1-422"><a href="r-code.html#cb1-422"></a>                   fet <span class="op">~</span><span class="st"> </span>cff,</span>
<span id="cb1-423"><a href="r-code.html#cb1-423"></a>                   <span class="dt">fun.aggregate =</span> sum, </span>
<span id="cb1-424"><a href="r-code.html#cb1-424"></a>                   <span class="dt">value.var =</span> <span class="st">&quot;N&quot;</span>)</span>
<span id="cb1-425"><a href="r-code.html#cb1-425"></a><span class="kw">setkey</span>(c3FetByCf, fet)</span>
<span id="cb1-426"><a href="r-code.html#cb1-426"></a><span class="co">## all c3 calls</span></span>
<span id="cb1-427"><a href="r-code.html#cb1-427"></a>c3Calls &lt;-<span class="st"> </span>c3[<span class="op">!</span><span class="kw">is.na</span>(mat) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(fet) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(cff), ][<span class="kw">order</span>(mat, fet, cff)]</span>
<span id="cb1-428"><a href="r-code.html#cb1-428"></a><span class="kw">kable</span>(c3FetByCf[ , .(<span class="st">&quot; &quot;</span> =<span class="st"> &quot;Fetal&quot;</span>, <span class="st">&quot; &quot;</span> =<span class="st"> </span>fet, <span class="st">`</span><span class="dt">0/0</span><span class="st">`</span>, <span class="st">`</span><span class="dt">0/1</span><span class="st">`</span>, <span class="st">`</span><span class="dt">1/1</span><span class="st">`</span>)], </span>
<span id="cb1-429"><a href="r-code.html#cb1-429"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-430"><a href="r-code.html#cb1-430"></a>      <span class="dt">caption =</span> <span class="st">&#39;Case 3 fetal versus cell-free genotype calls. ‘0’ represents the major allele; ‘1’ represents the minor allele. Sites with cell-free estimates and reliable direct fetal calls included (reliable defied as passing all quality checks and having a total sequencing depth greater than 30).&#39;</span>,</span>
<span id="cb1-431"><a href="r-code.html#cb1-431"></a>      <span class="dt">label =</span> <span class="st">&quot;c3FetByCf&quot;</span>,</span>
<span id="cb1-432"><a href="r-code.html#cb1-432"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-433"><a href="r-code.html#cb1-433"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-434"><a href="r-code.html#cb1-434"></a>      <span class="dt">caption.short =</span> <span class="st">&#39;Case 3 fetal versus cell-free genotype calls.&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-435"><a href="r-code.html#cb1-435"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-436"><a href="r-code.html#cb1-436"></a><span class="st">  </span><span class="kw">collapse_rows</span>(<span class="dt">columns =</span> <span class="dv">1</span>, <span class="dt">valign =</span> <span class="st">&quot;middle&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-437"><a href="r-code.html#cb1-437"></a><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot; &quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Cell-free&quot;</span> =<span class="st"> </span><span class="dv">3</span>))</span>
<span id="cb1-438"><a href="r-code.html#cb1-438"></a><span class="kw">kable</span>(c3Calls[ , .(<span class="dt">Maternal =</span> mat, <span class="dt">Fetal =</span> fet, <span class="st">`</span><span class="dt">Cell-free</span><span class="st">`</span> =<span class="st"> </span>cff, N)], </span>
<span id="cb1-439"><a href="r-code.html#cb1-439"></a>      <span class="dt">row.names =</span> <span class="ot">FALSE</span>,</span>
<span id="cb1-440"><a href="r-code.html#cb1-440"></a>      <span class="dt">caption =</span> <span class="st">&#39;Maternal, fetal, and cell-free genotype calls. ‘0’ represents the major allele; ‘1’ represents the minor allele. Sites with cell-free estimates and reliable direct fetal calls included (reliable defied as passing all quality checks and having a total sequencing depth greater than 30).&#39;</span>,</span>
<span id="cb1-441"><a href="r-code.html#cb1-441"></a>      <span class="dt">label =</span> <span class="st">&quot;c3Calls&quot;</span>,</span>
<span id="cb1-442"><a href="r-code.html#cb1-442"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">scientific =</span> <span class="ot">FALSE</span>),</span>
<span id="cb1-443"><a href="r-code.html#cb1-443"></a>      <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-444"><a href="r-code.html#cb1-444"></a>      <span class="dt">caption.short =</span> <span class="st">&#39;Maternal, fetal, and cell-free genotype calls.&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-445"><a href="r-code.html#cb1-445"></a><span class="st">  </span><span class="kw">kable_classic</span>() <span class="op">%&gt;%</span></span>
<span id="cb1-446"><a href="r-code.html#cb1-446"></a><span class="st">  </span><span class="kw">collapse_rows</span>(<span class="dt">columns =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">valign =</span> <span class="st">&quot;middle&quot;</span>, <span class="dt">latex_hline =</span> <span class="st">&quot;full&quot;</span>) </span>
<span id="cb1-447"><a href="r-code.html#cb1-447"></a><span class="kw">pltExpMAF</span>(<span class="dv">500</span>)</span>
<span id="cb1-448"><a href="r-code.html#cb1-448"></a><span class="kw">pltMissclass</span>()</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="references.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLFilerDissertation.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
